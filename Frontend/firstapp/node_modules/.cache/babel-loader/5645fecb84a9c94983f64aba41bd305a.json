{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pallavi\\\\Desktop\\\\React\\\\firstapp\\\\src\\\\components\\\\board\\\\Dashboard.js\";\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { useHistory } from \"react-router-dom\";\nimport { jwtDecode } from \"jwt-decode\";\nconst Dashboard = () => {\n  const [user, setUser] = useState(null);\n  const history = useHistory();\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    const role = localStorage.getItem(\"role\"); // ✅ Fetch role from storage\n\n    if (!token) {\n      history.push(\"/login\");\n      return;\n    }\n\n    // ✅ Redirect users based on role before fetching profile\n    if ((role === null || role === void 0 ? void 0 : role.toLowerCase()) === \"artist\") {\n      history.push(\"/artist-dashboard\");\n      return;\n    }\n    try {\n      const decodedToken = jwtDecode(token);\n      setUser(decodedToken);\n      axios.get(\"http://localhost:8080/api/users/profile\", {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      }).then(res => setUser(res.data)).catch(() => history.push(\"/login\"));\n    } catch (error) {\n      localStorage.removeItem(\"token\");\n      history.push(\"/login\");\n    }\n  }, [history]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }\n  }, \"Welcome, \", user ? user.name : \"User\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }\n  }, \"Username: \", user ? user.username : \"\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }\n  }, \"Role: \", user ? user.role : \"\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => {\n      localStorage.removeItem(\"token\");\n      history.push(\"/login\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }\n  }, \"Logout\"));\n};\nexport default Dashboard;","map":{"version":3,"names":["React","useEffect","useState","axios","useHistory","jwtDecode","Dashboard","user","setUser","history","token","localStorage","getItem","role","push","toLowerCase","decodedToken","get","headers","Authorization","then","res","data","catch","error","removeItem","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","name","username","onClick"],"sources":["C:/Users/Pallavi/Desktop/React/firstapp/src/components/board/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\n\r\nconst Dashboard = () => {\r\n  const [user, setUser] = useState(null);\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    const role = localStorage.getItem(\"role\"); // ✅ Fetch role from storage\r\n\r\n    if (!token) {\r\n      history.push(\"/login\");\r\n      return;\r\n    }\r\n\r\n    // ✅ Redirect users based on role before fetching profile\r\n    if (role?.toLowerCase() === \"artist\") {\r\n      history.push(\"/artist-dashboard\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const decodedToken = jwtDecode(token);\r\n      setUser(decodedToken);\r\n\r\n      axios\r\n        .get(\"http://localhost:8080/api/users/profile\", {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        })\r\n        .then((res) => setUser(res.data))\r\n        .catch(() => history.push(\"/login\"));\r\n    } catch (error) {\r\n      localStorage.removeItem(\"token\");\r\n      history.push(\"/login\");\r\n    }\r\n  }, [history]);\r\n\r\n  return (\r\n    <div>\r\n      <h2>Welcome, {user ? user.name : \"User\"}</h2>\r\n      <p>Username: {user ? user.username : \"\"}</p>\r\n      <p>Role: {user ? user.role : \"\"}</p>\r\n      <button\r\n        onClick={() => {\r\n          localStorage.removeItem(\"token\");\r\n          history.push(\"/login\");\r\n        }}\r\n      >\r\n        Logout\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,SAAS,QAAQ,YAAY;AAEtC,MAAMC,SAAS,GAAGA,CAAA,KAAM;EACtB,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGN,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAMO,OAAO,GAAGL,UAAU,CAAC,CAAC;EAE5BH,SAAS,CAAC,MAAM;IACd,MAAMS,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMC,IAAI,GAAGF,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;;IAE3C,IAAI,CAACF,KAAK,EAAE;MACVD,OAAO,CAACK,IAAI,CAAC,QAAQ,CAAC;MACtB;IACF;;IAEA;IACA,IAAI,CAAAD,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEE,WAAW,CAAC,CAAC,MAAK,QAAQ,EAAE;MACpCN,OAAO,CAACK,IAAI,CAAC,mBAAmB,CAAC;MACjC;IACF;IAEA,IAAI;MACF,MAAME,YAAY,GAAGX,SAAS,CAACK,KAAK,CAAC;MACrCF,OAAO,CAACQ,YAAY,CAAC;MAErBb,KAAK,CACFc,GAAG,CAAC,yCAAyC,EAAE;QAC9CC,OAAO,EAAE;UAAEC,aAAa,EAAE,UAAUT,KAAK;QAAG;MAC9C,CAAC,CAAC,CACDU,IAAI,CAAEC,GAAG,IAAKb,OAAO,CAACa,GAAG,CAACC,IAAI,CAAC,CAAC,CAChCC,KAAK,CAAC,MAAMd,OAAO,CAACK,IAAI,CAAC,QAAQ,CAAC,CAAC;IACxC,CAAC,CAAC,OAAOU,KAAK,EAAE;MACdb,YAAY,CAACc,UAAU,CAAC,OAAO,CAAC;MAChChB,OAAO,CAACK,IAAI,CAAC,QAAQ,CAAC;IACxB;EACF,CAAC,EAAE,CAACL,OAAO,CAAC,CAAC;EAEb,oBACET,KAAA,CAAA0B,aAAA;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACEhC,KAAA,CAAA0B,aAAA;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAI,WAAS,EAACzB,IAAI,GAAGA,IAAI,CAAC0B,IAAI,GAAG,MAAW,CAAC,eAC7CjC,KAAA,CAAA0B,aAAA;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAG,YAAU,EAACzB,IAAI,GAAGA,IAAI,CAAC2B,QAAQ,GAAG,EAAM,CAAC,eAC5ClC,KAAA,CAAA0B,aAAA;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAAG,QAAM,EAACzB,IAAI,GAAGA,IAAI,CAACM,IAAI,GAAG,EAAM,CAAC,eACpCb,KAAA,CAAA0B,aAAA;IACES,OAAO,EAAEA,CAAA,KAAM;MACbxB,YAAY,CAACc,UAAU,CAAC,OAAO,CAAC;MAChChB,OAAO,CAACK,IAAI,CAAC,QAAQ,CAAC;IACxB,CAAE;IAAAa,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GACH,QAEO,CACL,CAAC;AAEV,CAAC;AAED,eAAe1B,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module"}