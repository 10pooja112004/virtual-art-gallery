{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pallavi\\\\Desktop\\\\React\\\\firstapp\\\\src\\\\components\\\\board\\\\Dashboard.js\";\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { useHistory } from \"react-router-dom\"; // ✅ React Router v5\nimport { jwtDecode } from \"jwt-decode\";\nconst Dashboard = () => {\n  const [user, setUser] = useState(null);\n  const [profile, setProfile] = useState(null); // ✅ Store profile data separately\n  const history = useHistory();\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    if (!token) {\n      history.push(\"/login\"); // ✅ Redirect if no token\n      return;\n    }\n    try {\n      const decodedToken = jwtDecode(token); // ✅ Decode token\n      setUser(decodedToken); // ✅ Set user details from token\n    } catch (error) {\n      console.error(\"Invalid token:\", error);\n      localStorage.removeItem(\"token\");\n      history.push(\"/login\");\n    }\n  }, [history]);\n\n  // 🔹 Fetch profile only when needed (not on every render)\n  const fetchProfile = async () => {\n    const token = localStorage.getItem(\"token\");\n    if (!token) return;\n    try {\n      const response = await axios.get(\"http://localhost:8080/api/users/profile\", {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setProfile(response.data);\n    } catch (error) {\n      console.error(\"❌ Failed to fetch profile:\", error);\n    }\n  };\n\n  // 🔹 Logout and Redirect\n  const handleLogout = () => {\n    localStorage.removeItem(\"token\");\n    history.push(\"/login\");\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }\n  }, \"Welcome, \", user ? user.name : \"User\", \"!\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }\n  }, \"Username: \", user ? user.username : \"N/A\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }\n  }, \"Role: \", user ? user.role : \"N/A\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: fetchProfile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }, \"Load Profile\"), profile && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 11\n    }\n  }, \"Profile Information\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 11\n    }\n  }, \"Email: \", profile.email), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 11\n    }\n  }, \"Registered Since: \", profile.createdAt)), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleLogout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }\n  }, \"Logout\"));\n};\nexport default Dashboard;","map":{"version":3,"names":["React","useEffect","useState","axios","useHistory","jwtDecode","Dashboard","user","setUser","profile","setProfile","history","token","localStorage","getItem","push","decodedToken","error","console","removeItem","fetchProfile","response","get","headers","Authorization","data","handleLogout","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","name","username","role","onClick","email","createdAt"],"sources":["C:/Users/Pallavi/Desktop/React/firstapp/src/components/board/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useHistory } from \"react-router-dom\";  // ✅ React Router v5\r\nimport { jwtDecode } from \"jwt-decode\";\r\n\r\nconst Dashboard = () => {\r\n  const [user, setUser] = useState(null);\r\n  const [profile, setProfile] = useState(null); // ✅ Store profile data separately\r\n  const history = useHistory();  \r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n\r\n    if (!token) {\r\n      history.push(\"/login\");  // ✅ Redirect if no token\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const decodedToken = jwtDecode(token); // ✅ Decode token\r\n      setUser(decodedToken);  // ✅ Set user details from token\r\n    } catch (error) {\r\n      console.error(\"Invalid token:\", error);\r\n      localStorage.removeItem(\"token\");\r\n      history.push(\"/login\");\r\n    }\r\n  }, [history]);\r\n\r\n  // 🔹 Fetch profile only when needed (not on every render)\r\n  const fetchProfile = async () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) return;\r\n\r\n    try {\r\n      const response = await axios.get(\"http://localhost:8080/api/users/profile\", {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setProfile(response.data);\r\n    } catch (error) {\r\n      console.error(\"❌ Failed to fetch profile:\", error);\r\n    }\r\n  };\r\n\r\n  // 🔹 Logout and Redirect\r\n  const handleLogout = () => {\r\n    localStorage.removeItem(\"token\");\r\n    history.push(\"/login\"); \r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Welcome, {user ? user.name : \"User\"}!</h2>\r\n      <p>Username: {user ? user.username : \"N/A\"}</p>\r\n      <p>Role: {user ? user.role : \"N/A\"}</p>\r\n\r\n      {/* ✅ Load profile only when needed */}\r\n      <button onClick={fetchProfile}>Load Profile</button>\r\n\r\n      {/* ✅ Show profile details only if available */}\r\n      {profile && (\r\n        <div>\r\n          <h3>Profile Information</h3>\r\n          <p>Email: {profile.email}</p>\r\n          <p>Registered Since: {profile.createdAt}</p>\r\n        </div>\r\n      )}\r\n\r\n      <button onClick={handleLogout}>Logout</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}